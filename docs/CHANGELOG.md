# 更新日志

本文档记录项目的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [Semantic Versioning](https://semver.org/lang/zh-CN/)。

## [0.2.3] - 2024-01-13

### 新增
- 完成了图片预览组件的全部功能
  * 支持鼠标滚轮缩放（0.1-5.0倍）
  * 支持鼠标拖动查看细节
  * 支持适应窗口和重置视图
  * 优化的性能和用户体验

### 修复
- 修复了 SingleGenTab 类中配置初始化的问题
- 修复了预设管理相关的测试用例
  * 修复了预设加载时的参数键名不一致问题
  * 修复了预设管理对话框的刷新逻辑
  * 优化了预设列表的缓存机制
- 修复了图片预览组件的空 QPixmap 警告
- 修复了历史记录集成的问题
  * 添加了重复记录检查
  * 优化了历史记录更新机制
  * 添加了历史记录变更信号
- 优化了Qt组件的配置，减少警告信息

### 优化
- 改进了单元测试覆盖率
  * 单图生成功能：25个测试用例，全部通过
  * 图片预览功能：8个测试用例，全部通过
  * 批量生成功能：24个测试用例，全部通过
- 优化了代码结构和错误处理
  * 统一了参数键名规范
  * 增强了错误处理机制
  * 改进了信号连接逻辑
- 完善了文档说明
  * 更新了功能说明
  * 补充了开发文档
  * 完善了测试文档

### 测试
- 完成了单图生成功能的全面测试
  * 修复了历史记录集成测试
  * 完善了预设管理测试
  * 优化了参数验证测试
- 完成了图片预览功能的全面测试
- 完成了批量生成功能的全面测试
- 完成了配置管理、预设管理等功能的测试

## [0.2.2] - 2024-03-XX

### 改进
- 增强了任务队列的线程安全性和稳定性
  - 添加了线程安全的属性访问机制
  - 改进了资源清理和错误处理
  - 优化了事件同步机制
  - 增强了异常处理和日志记录
- 完善了任务队列的测试用例
  - 添加了更完整的线程生命周期测试
  - 改进了资源清理机制
  - 增强了错误处理测试

### 修复
- 修复了任务队列在停止时可能的死锁问题
- 修复了回调函数可能导致的异常传播问题
- 修复了任务状态更新的线程安全问题

## [0.2.1] - 2024-03-XX

### 新增
- 单图生成历史记录功能
  - 自动保存生成记录
  - 支持查看历史记录
  - 一键加载历史参数
  - 历史记录管理
  - 错误处理机制

### 修改
- 优化单图生成界面布局
- 添加历史记录侧边栏

### 修复
- 无

## [0.2.0] - 2024-XX-XX

### 新增
- 基础功能实现
- 单图生成功能
- 设置管理
- API集成

### 修改
- 无

### 修复
- 无

## [0.1.0] - 2024-01-12

### 新增
- 基础项目结构
- 单图生成界面
  - 基本参数配置
  - 实时预览功能
  - 图片保存功能
- API客户端封装
- 配置管理功能
- 设置界面
- 单元测试框架

### 修改
- 优化项目结构
- 改进错误处理
- 完善文档系统

### 修复
- 修复API连接问题
- 修复配置文件读写错误
- 修复UI组件渲染问题

## [0.2.4] - 2024-01-13

### 新增
- 多图片生成功能
  * 支持一次生成1-10张图片
  * 缩略图列表显示
  * 支持右键菜单单独保存
- 独立的历史记录窗口
  * 表格形式显示历史记录
  * 支持预览和加载历史记录
  * 支持导出历史记录
  * 支持打开历史图片
- 多行文本输入
  * 提示词支持多行输入
  * 负面提示词支持多行输入
  * 自动调整文本框大小

### 优化
- 优化界面布局
  * 移除多余的预览窗口
  * 添加缩略图列表
  * 改进历史记录显示
- 改进图片管理
  * 支持批量保存
  * 支持单独保存
  * 自动添加到历史记录
- 改进用户体验
  * 添加右键菜单功能
  * 优化历史记录管理
  * 改进错误提示

### 修复
- 修复API返回数据处理问题
- 修复历史记录加载错误
- 修复图片保存路径问题
- 修复随机种子设置问题

## [0.2.5] - 2024-01-14

### 新增
- 改进历史记录导出功能
  * 支持Excel格式导出
  * 支持图片预览嵌入
  * 优化表格布局和列宽
  * 自动调整行高适应图片
- 历史记录功能改进
  * 支持多图片记录
  * 优化记录保存逻辑
  * 改进历史记录显示

### 优化
- 优化Excel导出
  * 添加更多信息列
  * 优化列宽设置
  * 改进图片显示效果
- 改进用户体验
  * 优化导出文件选择
  * 添加导出进度提示
  * 改进错误处理

### 修复
- 修复历史记录只保存一张图片的问题
- 修复Excel导出格式问题
- 修复图片路径显示问题

## [1.2.0] - 2024-01-14

### 新增
- 批量生成功能
  - 支持多个提示词批量生成图片
  - 支持从TXT和Excel文件导入提示词
  - 显示生成进度和状态提示
  - 独立的历史记录管理
- 历史记录功能增强
  - 支持显示缩略图
  - 双击可还原参数设置
  - 可清空历史记录

### 修改
- 优化了图片保存逻辑，支持批量保存
- 改进了参数传递方式，确保与API要求一致
- 优化了界面布局，提供更好的用户体验

### 修复
- 修复了图片尺寸参数名称不一致的问题
- 修复了随机种子处理的问题
- 修复了历史记录显示的问题

## [1.2.1] - 2024-01-14

### 修改
- 优化了设置界面的种子值处理
  - 种子值现在默认为空，表示使用随机种子
  - 添加了清空按钮，方便清除种子值
  - 种子值范围调整为0-2147483647
  - 改进了种子值的保存和加载逻辑

### 修复
- 修复了种子值无法清空的问题
- 修复了设置界面中种子值显示的问题
- 优化了配置管理器中种子值的处理逻辑

## [1.2.2] - 2024-01-14

### 优化
- 改进随机种子功能的实现
  - 批量生成时每张图片使用不同的随机种子
  - 修复使用固定种子值时的问题
  - 优化种子值输入框的交互体验

### 改进
- 优化了种子值输入功能，支持更大范围的种子值(1-9999999999)
- 改进了种子值输入的验证机制，提供更好的用户体验

## 计划中的版本

### [0.3.0]
- 任务排序功能
- 批量参数设置
- 性能优化
- 集成测试

### [1.0.0]
- 完整功能集
- 全面的测试覆盖
- 性能优化
- 文档完善 

## [1.2.1] - 2024-01-14

### 修复
- 修复了历史记录管理界面中拖放排序功能的问题
  - 优化了拖放操作的处理逻辑
  - 确保拖放后所有内容（包括缩略图、文本等）正确显示
  - 改进了拖放过程中的视觉反馈

### 改进
- 优化了历史记录管理界面的用户体验
  - 添加了拖放指示器，提供更清晰的视觉反馈
  - 保持滚动位置，提升操作流畅度
  - 优化了数据同步机制，确保界面实时更新 

## [1.2.1] - 2024-01-14

### 改进
- 增强了API错误处理机制
  - 添加了请求重试机制，最多重试3次
  - 实现了指数退避策略，避免频繁重试
  - 细化了错误类型处理（429、503等状态码）
  - 增加了详细的错误日志记录

### 修复
- 修复了批量生成时可能出现的未知错误导致任务中断的问题
- 改进了网络超时和连接错误的处理逻辑 