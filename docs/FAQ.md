# 常见问题解答

## 1. 基本问题

### 1.1 如何开始使用？
1. 下载并安装程序
2. 在设置中配置API密钥
3. 选择输出路径
4. 开始生成图片

### 1.2 支持哪些操作系统？
目前仅支持 Windows 10/11 系统。

### 1.3 如何获取API密钥？
请访问 Silicon Flow 官网注册账号并申请API密钥。

## 2. 单图生成

### 2.1 如何选择合适的模型？
- stabilityai/stable-diffusion-3-5-large：最高质量，生成较慢
- stabilityai/stable-diffusion-3-medium：平衡质量和速度
- stabilityai/stable-diffusion-3-5-large-turbo：生成速度最快

### 2.2 如何使用多图生成功能？
A: 多图生成功能支持一次生成多张图片：
1. 在参数设置区的"生成数量"中设置需要生成的图片数量（1-10张）
2. 点击"生成图片"按钮开始生成
3. 生成的图片会显示在缩略图列表中
4. 点击缩略图可以在主预览区查看大图
5. 可以右键点击缩略图单独保存某张图片
6. 也可以点击"保存图片"一次性保存所有图片

### 2.3 如何使用历史记录功能？
A: 历史记录功能提供了多种方式查看和管理历史：
1. 在主界面右侧的历史记录列表中可以快速查看最近的记录
2. 点击"查看历史"按钮可以打开独立的历史记录窗口
3. 在历史记录窗口中可以：
   - 查看详细的生成参数和预览图
   - 加载历史记录的参数和图片
   - 导出历史记录到JSON文件
   - 清空历史记录
4. 点击历史记录中的"打开"按钮可以直接查看原图

### 2.4 历史记录保存在哪里？
默认保存在用户目录下的 `.silicon-flow/history.json` 文件中，可在设置中修改。

### 2.5 历史记录丢失怎么办？
1. 检查历史文件路径是否正确
2. 确认文件权限是否正常
3. 查看错误日志获取详细信息
4. 尝试从备份中恢复

### 2.6 如何管理历史记录数量？
在设置中可以：
1. 设置最大记录数量
2. 配置自动清理策略
3. 手动清空历史记录

### 2.7 如何管理生成的图片？
A: 程序提供了多种图片管理方式：
1. 缩略图列表：
   - 显示当前批次生成的所有图片
   - 点击查看大图
   - 右键菜单单独保存
2. 批量保存：
   - 点击"保存图片"按钮
   - 选择保存目录
   - 自动以时间戳命名
3. 历史记录：
   - 记录所有保存的图片
   - 支持预览和重新加载
   - 可以导出历史记录

### 2.8 如何使用多行输入？
A: 提示词和负面提示词现在支持多行输入：
1. 直接在输入框中按Enter键换行
2. 支持复制粘贴多行文本
3. 文本框会自动调整大小
4. 所有换行会在生成时保留

## 3. 批量生成

### 3.1 如何导入Excel文件？
1. 准备符合模板的Excel文件
2. 点击"导入"按钮选择文件
3. 确认导入的数据无误
4. 开始批量生成

### 3.2 支持哪些Excel格式？
支持 .xlsx、.xls 和 .csv 格式。

## 4. 设置相关

### 4.1 如何修改输出路径？
在设置页面的"输出设置"中修改默认保存路径。

### 4.2 如何配置历史记录？
在设置页面的"历史记录"中可以：
1. 设置历史文件保存路径
2. 配置最大记录数量
3. 设置自动清理策略
4. 启用/禁用历史记录功能

### 4.3 如何备份配置？
1. 导出配置文件
2. 备份历史记录文件
3. 保存API密钥信息

## 5. 错误处理

### 5.1 生成失败怎么办？
1. 检查API密钥是否有效
2. 确认网络连接正常
3. 查看错误提示信息
4. 检查参数是否合理

### 5.2 历史记录相关错误
1. 文件读写错误
   - 检查文件权限
   - 确认路径是否存在
   - 验证磁盘空间充足

2. 历史加载失败
   - 检查文件格式是否正确
   - 尝试手动修复JSON文件
   - 从备份恢复文件

3. 记录保存失败
   - 确认目录可写
   - 检查磁盘空间
   - 查看错误日志

## 6. 性能优化

### 6.1 如何提高生成速度？
1. 选择turbo模型
2. 减少生成步数
3. 使用较小的图片尺寸
4. 关闭不必要的功能

### 6.2 如何减少内存占用？
1. 定期清理历史记录
2. 及时保存并关闭图片
3. 避免同时打开过多窗口

## 7. 安全问题

### 7.1 API密钥安全
1. 不要分享配置文件
2. 定期更换API密钥
3. 使用环境变量存储

### 7.2 历史记录安全
1. 定期清理敏感记录
2. 设置合适的文件权限
3. 注意备份文件安全

## 8. 更新与维护

### 8.1 如何更新程序？
1. 下载最新版本
2. 备份当前配置
3. 安装新版本
4. 恢复配置信息

### 8.2 如何提交问题反馈？
1. 收集错误日志
2. 描述问题现象
3. 提供复现步骤
4. 通过官方渠道反馈

## 任务队列相关

### Q: 任务队列是如何工作的？
A: 任务队列使用后台线程处理批量图片生成任务。它提供了任务添加、暂停、恢复和停止等功能，并通过回调机制报告进度和结果。任务按照添加顺序依次处理，支持实时查看状态和进度。

### Q: 如何处理任务失败的情况？
A: 当任务失败时：
1. 任务状态会被标记为"失败"
2. 错误信息会通过回调函数通知界面
3. 失败的任务不会重试，但保留在任务列表中
4. 其他任务会继续处理
5. 您可以在界面上查看具体的错误原因

### Q: 为什么任务队列会停止工作？
A: 任务队列可能因以下原因停止：
1. 手动点击停止按钮
2. 所有任务处理完成
3. API调用出现严重错误
4. 系统资源不足
解决方法：检查错误日志，确保API可用，然后重新启动队列。

### Q: 暂停后的任务会丢失吗？
A: 不会。暂停操作会：
1. 等待当前任务完成
2. 保持队列中的任务不变
3. 维持任务状态和顺序
4. 可以随时恢复处理
所有任务都会被保留直到完成或手动清除。

### Q: 如何提高任务处理效率？
A: 建议：
1. 合理设置任务数量
2. 避免过于频繁的暂停/恢复
3. 确保网络连接稳定
4. 定期清理已完成的任务
5. 监控系统资源使用 

## 图片预览相关

### 基本操作

Q: 如何放大/缩小查看图片？
A: 使用鼠标滚轮可以放大或缩小图片。向上滚动放大，向下滚动缩小。支持的缩放范围是 0.1-5.0 倍。

Q: 如何查看图片的其他部分？
A: 当图片被放大时，按住鼠标左键可以拖动图片查看其他部分。鼠标会变成抓手形状，表示可以拖动。

Q: 如何快速恢复图片的原始大小？
A: 点击工具栏的"重置视图"按钮，或使用快捷键（待实现），可以立即将图片恢复到原始大小和位置。

Q: 如何让图片适应窗口大小？
A: 点击工具栏的"适应窗口"按钮，或使用快捷键（待实现），图片会自动缩放到最适合当前窗口的大小。

### 性能问题

Q: 为什么图片预览时感觉有点卡顿？
A: 可能的原因：
1. 图片分辨率过高，建议使用不超过 4K 的图片
2. 系统内存不足，建议关闭其他占用内存的程序
3. CPU 使用率过高，建议等待其他任务完成后再操作

Q: 放大图片时为什么看起来有点模糊？
A: 这是正常现象。为了保证性能，图片放大时会使用平滑缩放算法。如果需要查看细节，建议使用原始分辨率更高的图片。

Q: 拖动图片时为什么有时会卡住？
A: 这通常是因为达到了可拖动的边界。图片不能被拖出显示区域，当到达边界时会自动停止。

### 常见问题

Q: 为什么有些图片无法加载？
A: 可能的原因：
1. 图片文件已损坏或格式不支持
2. 文件权限不足
3. 系统内存不足
建议检查图片文件是否完整，并确保使用支持的格式（PNG、JPG等）。

Q: 窗口大小改变后图片显示异常怎么办？
A: 尝试以下方法：
1. 点击"重置视图"按钮
2. 点击"适应窗口"按钮
3. 如果仍有问题，尝试重新加载图片

Q: 如何提高图片预览的性能？
A: 建议：
1. 使用适当分辨率的图片，避免超大图片
2. 保持足够的系统内存
3. 关闭不需要的后台程序
4. 使用独立显卡的设备性能会更好

### 高级功能

Q: 是否支持触控板手势？
A: 目前主要支持鼠标操作。触控板支持将在后续版本中添加。

Q: 是否支持键盘快捷键？
A: 键盘快捷键支持将在后续版本中添加，包括：
- 重置视图
- 适应窗口
- 精确缩放控制

Q: 是否支持多图片同时预览？
A: 目前仅支持单图片预览。多图片预览功能将在后续版本中考虑添加。

## 批量生成相关

### Q: 如何使用批量生成功能？
A: 批量生成功能支持通过Excel文件导入多个生成任务。具体步骤：
1. 点击"导入Excel"按钮选择Excel文件
2. 确认任务列表无误后点击"开始生成"
3. 等待所有任务完成
4. 点击"导出Excel"保存结果

### Q: Excel文件需要什么格式？
A: Excel文件必须包含以下列：
- 提示词：图片生成的提示词
- 模型：使用的模型名称
- 尺寸：图片尺寸
您可以点击"下载模板"获取标准格式的Excel模板。

### Q: 为什么任务状态显示"失败"？
A: 任务失败可能有以下原因：
1. API密钥无效或已过期
2. 网络连接不稳定
3. 服务器响应超时
4. 提示词不符合要求
请检查错误提示并相应处理。

### Q: 如何暂停和继续任务？
A: 在生成过程中：
- 点击"暂停"按钮可以暂停当前任务
- 点击"继续"按钮可以恢复任务处理
- 点击"停止"按钮可以完全停止任务
暂停后的任务会保留在列表中，可以随时继续。

### Q: 如何编辑已添加的任务？
A: 在任务列表中：
1. 找到要编辑的任务
2. 点击"编辑"按钮
3. 在弹出的对话框中修改参数
4. 点击"确定"保存修改
注意：已完成的任务如果修改参数会重置状态。

### Q: 为什么有些任务处理很慢？
A: 任务处理速度受多个因素影响：
1. 网络连接速度
2. 服务器负载
3. 图片尺寸大小
4. 当前处理的任务数量
建议适当控制并发任务数量，确保网络稳定。

### Q: 如何查看生成的图片？
A: 有两种方式：
1. 在任务列表中点击"打开"按钮直接查看
2. 导出Excel后通过结果路径找到图片文件

### Q: 任务列表支持排序吗？
A: 是的，任务列表支持：
- 按提示词排序
- 按状态排序
点击相应的排序按钮即可。

### Q: 如何清空任务列表？
A: 点击"清空"按钮可以清空所有任务。注意：
- 正在处理的任务会被停止
- 已完成的任务记录会被清除
- 生成的图片文件不会被删除 

## API相关问题

### Q: 为什么API密钥验证成功但生成图片失败？
A: 可能有以下几个原因：
1. API密钥已过期或被重置
2. 达到请求限制（每分钟/每天）
3. 服务器负载过高
4. 参数设置不正确（如turbo模型必须使用4步）

### Q: 如何处理"API密钥无效"错误？
A: 请按以下步骤检查：
1. 确认API密钥是否正确复制（注意不要有多余的空格）
2. 在设置页面重新输入API密钥并点击"测试"按钮
3. 如果仍然失败，请尝试重新生成API密钥

### Q: 为什么有时候生成图片特别慢？
A: 生成速度受多个因素影响：
1. 选择的模型（turbo模型最快）
2. 生成步数（步数越多越慢）
3. 服务器当前负载
4. 网络状况

### Q: 如何优化图片生成速度？
A: 可以尝试以下方法：
1. 使用turbo模型（固定4步）
2. 减少生成步数（非turbo模型）
3. 选择较小的图片尺寸
4. 避开高峰期使用

### Q: 为什么有时候会提示"请求过于频繁"？
A: API服务有请求频率限制：
1. 单个API密钥每分钟最多10次请求
2. 单个API密钥每天最多1000次请求
建议：
1. 合理控制请求频率
2. 批量生成时设置适当的间隔
3. 如有大量需求，可以申请提升限额

### Q: 如何处理"服务暂时不可用"错误？
A: 遇到此错误时：
1. 等待几分钟后重试
2. 检查服务状态页面
3. 如果持续出现，可以联系客服

### Q: 为什么相同的参数生成的图片每次都不一样？
A: 这是正常现象，因为：
1. 默认使用随机种子
2. 如需生成相同的图片，请：
   - 取消"随机种子"选项
   - 设置固定的种子值
   - 保持其他参数完全相同

### Q: 如何正确设置生成参数？
A: 参数设置建议：
1. 提示词：具体、清晰、符合模型特点
2. 引导系数：
   - 写实风格：7.0-8.0
   - 艺术风格：8.0-12.0
3. 生成步数：
   - turbo模型：固定4步
   - 其他模型：20-30步效果较好
4. 图片尺寸：根据需求选择，较大尺寸生成较慢

### Q: 如何保存和使用生成参数预设？
A: 使用预设功能：
1. 调整好参数后点击"保存预设"
2. 输入预设名称保存
3. 下次使用时从预设下拉框选择
4. 预设包含：
   - 提示词
   - 反向提示词
   - 模型选择
   - 图片尺寸
   - 生成步数
   - 引导系数

### Q: 批量生成时如何避免失败？
A: 建议采取以下措施：
1. 合理设置任务数量
2. 使用较短的生成步数
3. 设置任务间隔
4. 定期保存生成结果
5. 出错时及时查看错误信息 

## API错误处理相关问题

### Q: 为什么生成图片时会出现"未知错误"？
A: "未知错误"可能有以下几个原因：
1. 网络连接不稳定
2. API服务器暂时性故障
3. 请求参数格式错误

解决方案：
- 检查网络连接
- 等待几分钟后重试
- 确认参数格式正确

### Q: 遇到"API请求超出限制"怎么办？
A: 这表示短时间内发送了太多请求。系统会自动等待并重试，您可以：
1. 等待自动重试完成
2. 减少并发请求数量
3. 增加请求间隔时间

### Q: 生成过程中断该如何处理？
A: 程序会自动进行以下处理：
1. 自动重试最多3次
2. 每次重试间隔时间递增
3. 记录详细错误日志

如果仍然失败，建议：
1. 检查网络连接
2. 查看错误日志了解具体原因
3. 必要时联系技术支持 

## 安装和配置

### Q: 安装后无法运行程序怎么办？
A: 请检查以下几点：
1. Python版本是否为3.13或更高
2. 是否已安装所有依赖（运行 `pip install -r requirements.txt`）
3. 是否已正确配置API密钥

### Q: 保存图片时出现"No such file or directory"错误怎么办？
A: 这个问题可能有以下几个原因：
1. 输出目录不存在或没有写入权限
2. 预设目录路径配置错误
3. 文件名包含非法字符

解决方法：
1. 检查输出目录（默认为 `D:/AI project/图片`）是否存在且有写入权限
2. 确保配置文件（`~/.image_generator/config.json`）中的路径设置正确
3. 如果问题仍然存在，可以尝试删除配置文件，让程序重新生成默认配置 

## 独立运行版本相关问题

### Q: 独立运行版本和源代码版本有什么区别？
A: 独立运行版本（exe文件）已经包含了所有必要的依赖，可以直接在Windows系统上运行，不需要安装Python环境。而源代码版本需要配置Python环境和安装依赖包。

### Q: 为什么独立运行版本文件这么大？
A: 独立运行版本包含了所有必要的依赖库（如PyQt6、pandas等）和运行环境，所以文件较大，这是正常的。

### Q: 独立运行版本可以在任何Windows电脑上运行吗？
A: 理论上可以在任何64位Windows系统上运行，但可能需要安装Visual C++ Redistributable 2022。如果运行时提示缺少DLL，请安装该组件。

### Q: 如何更新独立运行版本？
A: 下载新版本的exe文件，替换原有文件即可。建议在替换前备份配置文件（config目录）和历史记录（history目录）。

### Q: 独立运行版本的配置文件在哪里？
A: 所有配置文件都存储在程序所在目录的子文件夹中：
- config：配置文件
- output：生成的图片
- presets：预设配置
- history：历史记录

### Q: 杀毒软件报警怎么办？
A: 这是因为程序是打包的exe文件，某些杀毒软件可能会误报。可以：
1. 将程序添加到杀毒软件的白名单中
2. 使用源代码版本
3. 等待杀毒软件更新病毒库 

## 历史记录管理

### Q: 如何调整历史记录的顺序？
A: 在历史记录管理界面中，您可以通过以下方式调整记录顺序：
1. 点击并按住要移动的记录
2. 拖动到目标位置（会有蓝色指示线显示）
3. 释放鼠标完成移动
记录的新顺序会自动保存。

### Q: 如何快速打开生成的图片？
A: 有两种方式可以快速访问图片：
1. 双击记录行直接打开图片
2. 右键点击记录，选择"打开图片所在文件夹"，系统会打开文件夹并自动选中该图片

### Q: 如何批量删除历史记录？
A: 批量删除记录可以通过以下步骤：
1. 使用复选框选择要删除的记录，或按住Ctrl键点选多条记录
2. 点击"删除记录"按钮（仅删除记录）或"删除记录和文件"按钮（同时删除图片文件）
3. 确认删除操作

### Q: 导出到Excel时图片显示不完整怎么办？
A: 最新版本已优化Excel导出功能：
1. 图片会自动缩放以适应单元格
2. 行高会自动调整以完整显示图片
3. 如果仍有显示问题，可以在Excel中手动调整行高

### Q: 为什么有些图片无法打开？
A: 无法打开图片可能有以下原因：
1. 图片文件已被移动或删除
2. 文件权限不足
3. 文件被其他程序占用
建议使用"打开图片所在文件夹"功能检查文件是否存在。 